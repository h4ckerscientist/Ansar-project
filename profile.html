<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ü—Ä–æ—Ñ–∏–ª—å</title>
<link rel="stylesheet" href="styleprof.css">
<link rel="stylesheet" href="style.css">
</head>
<body>
   <header>


    <nav>
        <div class="town">
           <img src="media/location.png" alt="loc" class="loc">
           <p><span id="city"></span></p>
        </div>
        <a href="pr.html" class="el2">–ù–∞–π—Ç–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</a>
        <a href="index.html" class="el3"><img src="media/logo.png" alt="home" style="size: 200px 200px;" class="logo"></a>
        
        <a href="profile.html" class="el5"><img src="media/auth.png" alt="auth" class="auth"></a>
    </nav>
  </header>

  <main>
    <h1>üë§ –ü—Ä–æ—Ñ–∏–ª—å</h1>
    <p><strong>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:</strong> <span id="username">-</span></p>

    <h2>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π</h2>
    <form onsubmit="savePrefs(event)">
      <label for="prefMood">–õ—é–±–∏–º–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ:</label>
      <select id="prefMood">
        <option value="–∞–∫—Ç–∏–≤–Ω–æ–µ">–ê–∫—Ç–∏–≤–Ω–æ–µ</option>
        <option value="—Å–ø–æ–∫–æ–π–Ω–æ–µ">–°–ø–æ–∫–æ–π–Ω–æ–µ</option>
        <option value="—Ä–æ–º–∞–Ω—Ç–∏—á–Ω–æ–µ">–†–æ–º–∞–Ω—Ç–∏—á–Ω–æ–µ</option>
      </select>

      <label for="prefTime">–õ—é–±–∏–º–æ–µ –≤—Ä–µ–º—è —Å—É—Ç–æ–∫:</label>
      <select id="prefTime">
        <option value="morning">–£—Ç—Ä–æ</option>
        <option value="day">–î–µ–Ω—å</option>
        <option value="evening">–í–µ—á–µ—Ä</option>
      </select>

      <label for="prefBudget">–°—Ä–µ–¥–Ω–∏–π –±—é–¥–∂–µ—Ç (‚ÇΩ):</label>
      <input type="number" id="prefBudget">

      <label for="prefPeople">–û–±—ã—á–Ω–æ –ª—é–¥–µ–π:</label>
      <input type="number" id="prefPeople">

      <button type="submit" class="toFilter">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    </form>

    <h2>üïì –ò—Å—Ç–æ—Ä–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π</h2>
    <ul id="historyList"></ul>
    <button onclick="clearHistory()" class="toFilter">–û—á–∏—Å—Ç–∏—Ç—å –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é</button>

    <h2>‚≠ê –ò–∑–±—Ä–∞–Ω–Ω–æ–µ</h2>
    <ul id="favoritesList"></ul>

    
    <button onclick="logout()" class="toFilter">–í—ã–π—Ç–∏</button>
  </main>

  <script>
    const isLoggedIn = localStorage.getItem('isLoggedIn');
    const user = JSON.parse(localStorage.getItem('user'));

    if (!user || isLoggedIn !== 'true') {
      location.href = 'login.html';
    }

    document.getElementById('username').textContent = user.username;

    function logout() {
      localStorage.removeItem('isLoggedIn');
      localStorage.removeItem('user');
      location.href = 'login.html';
    }

    function getHistory() {
      return JSON.parse(localStorage.getItem('history')) || [];
    }

    function saveHistory(arr) {
      localStorage.setItem('history', JSON.stringify(arr));
    }

    function renderHistory() {
      const history = getHistory();
      const list = document.getElementById('historyList');
      list.innerHTML = '';

      if (history.length === 0) {
        list.innerHTML = '<li>–ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞</li>';
        return;
      }

      history.slice().reverse().forEach((item, reversedIndex) => {
        const li = document.createElement('li');
        li.style.display = 'flex';
        li.style.justifyContent = 'space-between';
        li.style.alignItems = 'center';

        const span = document.createElement('span');
        span.textContent = item;

        const btn = document.createElement('button');
        btn.textContent = '‚ùå';
        btn.title = '–£–¥–∞–ª–∏—Ç—å';
        btn.onclick = () => {
          const history = getHistory();
          const index = history.length - 1 - reversedIndex;
          history.splice(index, 1);
          saveHistory(history);
          renderHistory();
        };

        li.appendChild(span);
        li.appendChild(btn);
        list.appendChild(li);
      });
    }

    function clearHistory() {
      if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π?')) {
        localStorage.removeItem('history');
        renderHistory();
      }
    }

    function savePrefs(event) {
      event.preventDefault();
      alert('–ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã (–ª–æ–∫–∞–ª—å–Ω–æ)');
    }
function getFavorites() {
  return JSON.parse(localStorage.getItem('favorites')) || [];
}

function saveFavorites(favs) {
  localStorage.setItem('favorites', JSON.stringify(favs));
}

function renderFavorites() {
  const favorites = getFavorites();
  const list = document.getElementById('favoritesList');
  list.innerHTML = '';

  if (favorites.length === 0) {
    list.innerHTML = '<li>–°–ø–∏—Å–æ–∫ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ –ø—É—Å—Ç</li>';
    return;
  }

  favorites.forEach((item, index) => {
    const li = document.createElement('li');
    li.style.display = 'flex';
    li.style.justifyContent = 'space-between';
    li.style.alignItems = 'center';

    const span = document.createElement('span');
    span.textContent = item;

    const btn = document.createElement('button');
    btn.textContent = '‚ùå';
    btn.title = '–£–¥–∞–ª–∏—Ç—å';
    btn.onclick = () => {
      const favs = getFavorites();
      favs.splice(index, 1);
      saveFavorites(favs);
      renderFavorites();
    };

    li.appendChild(span);
    li.appendChild(btn);
    list.appendChild(li);
  });
}

    renderFavorites();
    renderHistory();
  </script>
</body>
</html>
